{"lockfile-version":1,"manifest":{"hook":{"on-activate":"\nexport PGDIR=\"$FLOX_ENV_CACHE/postgres\"\nexport PGDATA=$PGDIR/data\nexport PGHOST=$PGDIR/run\nexport PGCONFIGFILE=\"$PGDIR/postgresql.conf\"\nexport LOG_PATH=$PGHOST/LOG\nexport SESSION_SECRET=\"$USER-session-secret\"\nexport DATABASE_URL=\"postgresql:///$PGDATABASE?host=$PGHOST&port=$PGPORT\"\n\nif [[ ! -d \"$PGHOST\" ]]; then\n  mkdir -p \"$PGHOST\"\nfi\n\nif [[ ! -d \"$PGDATA\" ]]; then\n  mkdir -p \"$PGDATA\"\n  pg_initdb() {\n    initdb \"$PGDATA\" \\\n      --locale=C \\\n      --encoding=UTF8 \\\n      -A md5 \\\n      --auth=trust \\\n      --username $PGUSER \\\n      --pwfile=<(echo $PGPASS)\n  }\n  export -f pg_initdb  # This is needed for gum to be able to call function\n  if [[ \"$FLOX_ENVS_TESTING\" == \"1\" ]]; then\n    pg_initdb\n  else\n    gum spin --spinner dot --title \"Running initdb in $PGDATA\" -- bash -c pg_initdb\n  fi\n  echo \"✅ Initialize PostgreSQL ($PGDATA)\"\n\nfi\n\n\n#\nif [[ ! -f \"$PGCONFIGFILE\" ]]; then\n  tee -a $PGCONFIGFILE > /dev/null << EOF\nlisten_addresses = '$PGHOSTADDR';\nport = '$PGPORT';\nunix_socket_directories = '$PGHOST';\nunix_socket_permissions = '0700';\nEOF\n  echo \"✅ Configure PostgreSQL ($PGCONFIGFILE)\"\nfi\n\npg_ctl -D \"$PGDATA\" -w start -o \"-c unix_socket_directories=$PGHOST -c listen_addresses=$PGHOSTADDR -p $PGPORT\" > /dev/null\nif psql -lqt | cut -d \\| -f 1 | grep -qw $PGDATABASE; then\n  echo \"✅ Database '$PGDATABASE' already exists\"\nelse\n  createdb\n  echo \"✅ Database '$PGDATABASE' created\"\nfi\npg_ctl -D \"$PGDATA\" -m fast -w stop > /dev/null\n\n"},"install":{"gum":{"pkg-path":"gum"},"postgresql":{"pkg-path":"postgresql_16"}},"options":{"allow":{"licenses":[]},"semver":{},"systems":["aarch64-darwin","aarch64-linux","x86_64-darwin","x86_64-linux"]},"profile":{"common":"echo \"\"\necho \"     ╔═══════════════════════════════════════════════╗\"\necho \"     ║                                               ║\"\necho \"     ║  Start PostgreSQL in the background:          ║\"\necho \"     ║  👉 flox services start                       ║\"\necho \"     ║  👉 flox activate --start-services            ║\"\necho \"     ║                                               ║\"\necho \"     ║  Try to connect to PostgreSQL:                ║\"\necho \"     ║  👉 psql                                      ║\"\necho \"     ║                                               ║\"\necho \"     ╚═══════════════════════════════════════════════╝\"\necho \"\"\n"},"services":{"postgres":{"command":"postgres -D $PGDATA -c unix_socket_directories=$PGHOST -c listen_addresses=$PGHOSTADDR -p $PGPORT","is-daemon":null,"shutdown":null,"systems":null,"vars":null}},"vars":{"PGDATABASE":"pgdb","PGHOSTADDR":"127.0.0.1","PGPASS":"pgpass","PGPORT":"15432","PGUSER":"pguser"},"version":1},"packages":[{"attr_path":"gum","broken":false,"derivation":"/nix/store/rf7qipzf7sani2690rkiprm4d0ikrypi-gum-0.14.5.drv","description":"Tasty Bubble Gum for your shell","group":"toplevel","install_id":"gum","license":"MIT","locked_url":"https://github.com/flox/nixpkgs?rev=06cf0e1da4208d3766d898b7fdab6513366d45b9","name":"gum-0.14.5","outputs":{"out":"/nix/store/n1gqffrwdzr3vpsmwmwx3hmw814c1k6g-gum-0.14.5"},"outputs_to_install":["out"],"pname":"gum","priority":5,"rev":"06cf0e1da4208d3766d898b7fdab6513366d45b9","rev_count":687049,"rev_date":"2024-09-29T18:20:51Z","scrape_date":"2024-10-01T03:19:19Z","stabilities":["unstable"],"system":"aarch64-darwin","unfree":false,"version":"0.14.5"},{"attr_path":"gum","broken":false,"derivation":"/nix/store/igrp0rimwsnvj7l72iv0sagbbyn3kzqy-gum-0.14.5.drv","description":"Tasty Bubble Gum for your shell","group":"toplevel","install_id":"gum","license":"MIT","locked_url":"https://github.com/flox/nixpkgs?rev=06cf0e1da4208d3766d898b7fdab6513366d45b9","name":"gum-0.14.5","outputs":{"out":"/nix/store/ggp10jr3l6higs0gqibp6ypjlf7yakpc-gum-0.14.5"},"outputs_to_install":["out"],"pname":"gum","priority":5,"rev":"06cf0e1da4208d3766d898b7fdab6513366d45b9","rev_count":687049,"rev_date":"2024-09-29T18:20:51Z","scrape_date":"2024-10-01T03:19:19Z","stabilities":["unstable"],"system":"aarch64-linux","unfree":false,"version":"0.14.5"},{"attr_path":"gum","broken":false,"derivation":"/nix/store/a93pnfn8q8r8kpgbkjn94x8mqa2vxc5g-gum-0.14.5.drv","description":"Tasty Bubble Gum for your shell","group":"toplevel","install_id":"gum","license":"MIT","locked_url":"https://github.com/flox/nixpkgs?rev=06cf0e1da4208d3766d898b7fdab6513366d45b9","name":"gum-0.14.5","outputs":{"out":"/nix/store/jq8shghha81s1wg67fcjrfnf4hbliimn-gum-0.14.5"},"outputs_to_install":["out"],"pname":"gum","priority":5,"rev":"06cf0e1da4208d3766d898b7fdab6513366d45b9","rev_count":687049,"rev_date":"2024-09-29T18:20:51Z","scrape_date":"2024-10-01T03:19:19Z","stabilities":["unstable"],"system":"x86_64-darwin","unfree":false,"version":"0.14.5"},{"attr_path":"gum","broken":false,"derivation":"/nix/store/sxn2f2zrjhzi1b47qbp7llmww0gqz76v-gum-0.14.5.drv","description":"Tasty Bubble Gum for your shell","group":"toplevel","install_id":"gum","license":"MIT","locked_url":"https://github.com/flox/nixpkgs?rev=06cf0e1da4208d3766d898b7fdab6513366d45b9","name":"gum-0.14.5","outputs":{"out":"/nix/store/f199acwir08z47f3d5kf1fhmhajmd1ig-gum-0.14.5"},"outputs_to_install":["out"],"pname":"gum","priority":5,"rev":"06cf0e1da4208d3766d898b7fdab6513366d45b9","rev_count":687049,"rev_date":"2024-09-29T18:20:51Z","scrape_date":"2024-10-01T03:19:19Z","stabilities":["unstable"],"system":"x86_64-linux","unfree":false,"version":"0.14.5"},{"attr_path":"postgresql_16","broken":false,"derivation":"/nix/store/6wlxc9lliwl6b7h85nmmdvgk7dxc9vha-postgresql-16.4.drv","description":"Powerful, open source object-relational database system","group":"toplevel","install_id":"postgresql","license":"PostgreSQL","locked_url":"https://github.com/flox/nixpkgs?rev=06cf0e1da4208d3766d898b7fdab6513366d45b9","name":"postgresql-16.4","outputs":{"dev":"/nix/store/63r8cs0kjscq50r93k97aijddx2mjwm9-postgresql-16.4-dev","doc":"/nix/store/akn2wpw56q2cwwpa3kdd4isklaqk375s-postgresql-16.4-doc","lib":"/nix/store/5i4svw3nbn239hhzrl857bkbqb5h1aq1-postgresql-16.4-lib","man":"/nix/store/npkdasdws60qy0j0kznqwnbizcjx5m0q-postgresql-16.4-man","out":"/nix/store/fln3gcl40fwynfjr5fkpyqjhll4jqyhm-postgresql-16.4"},"outputs_to_install":["out","man"],"pname":"postgresql_16","priority":5,"rev":"06cf0e1da4208d3766d898b7fdab6513366d45b9","rev_count":687049,"rev_date":"2024-09-29T18:20:51Z","scrape_date":"2024-10-01T03:19:19Z","stabilities":["unstable"],"system":"aarch64-darwin","unfree":false,"version":"postgresql-16.4"},{"attr_path":"postgresql_16","broken":false,"derivation":"/nix/store/05pf2qmik1sg85z8kkl3rmxz6r9pg22c-postgresql-16.4.drv","description":"Powerful, open source object-relational database system","group":"toplevel","install_id":"postgresql","license":"PostgreSQL","locked_url":"https://github.com/flox/nixpkgs?rev=06cf0e1da4208d3766d898b7fdab6513366d45b9","name":"postgresql-16.4","outputs":{"debug":"/nix/store/w6hs71a695sf2n00km946bb1v36xc2qg-postgresql-16.4-debug","dev":"/nix/store/ycbf1qw3x8wc3a7z6mjwkzmyhc43s2wn-postgresql-16.4-dev","doc":"/nix/store/bh5km6cln45kf1pfwahdslpc9cydrm4v-postgresql-16.4-doc","lib":"/nix/store/3crpddg2akfnpg19plbbfyxny13ygdaf-postgresql-16.4-lib","man":"/nix/store/4i96xjnrsxgcpizmr6v7gmc25zminnl2-postgresql-16.4-man","out":"/nix/store/7bm8jppsyml2lkzzbw5kg6ahmvwlnxsb-postgresql-16.4"},"outputs_to_install":["out","man"],"pname":"postgresql_16","priority":5,"rev":"06cf0e1da4208d3766d898b7fdab6513366d45b9","rev_count":687049,"rev_date":"2024-09-29T18:20:51Z","scrape_date":"2024-10-01T03:19:19Z","stabilities":["unstable"],"system":"aarch64-linux","unfree":false,"version":"postgresql-16.4"},{"attr_path":"postgresql_16","broken":false,"derivation":"/nix/store/2v9zdgagajn3x6a9wg0hxz5smg9j75w2-postgresql-16.4.drv","description":"Powerful, open source object-relational database system","group":"toplevel","install_id":"postgresql","license":"PostgreSQL","locked_url":"https://github.com/flox/nixpkgs?rev=06cf0e1da4208d3766d898b7fdab6513366d45b9","name":"postgresql-16.4","outputs":{"dev":"/nix/store/sb23d37zmmymsn268d9lcpgd0j939117-postgresql-16.4-dev","doc":"/nix/store/ayarhx2gw8y5j648r4jfsl8l54s5nb8i-postgresql-16.4-doc","lib":"/nix/store/k5n25gjgfbxwyjhzf2il0b93q18gdsr7-postgresql-16.4-lib","man":"/nix/store/n66gp6v6zd5fxwh2j72jjx5d427fpibp-postgresql-16.4-man","out":"/nix/store/ywikp0nf87afr4qs2dvjxiknwzyf6n5b-postgresql-16.4"},"outputs_to_install":["out","man"],"pname":"postgresql_16","priority":5,"rev":"06cf0e1da4208d3766d898b7fdab6513366d45b9","rev_count":687049,"rev_date":"2024-09-29T18:20:51Z","scrape_date":"2024-10-01T03:19:19Z","stabilities":["unstable"],"system":"x86_64-darwin","unfree":false,"version":"postgresql-16.4"},{"attr_path":"postgresql_16","broken":false,"derivation":"/nix/store/vd5dp82lyrd1s0lkbcqshy1mjsjzbs3w-postgresql-16.4.drv","description":"Powerful, open source object-relational database system","group":"toplevel","install_id":"postgresql","license":"PostgreSQL","locked_url":"https://github.com/flox/nixpkgs?rev=06cf0e1da4208d3766d898b7fdab6513366d45b9","name":"postgresql-16.4","outputs":{"debug":"/nix/store/isrqqmd5ckwwsgk708q981h3h7ijixkv-postgresql-16.4-debug","dev":"/nix/store/45if5nl708nhayxnaqh7h2scz9pn4mn8-postgresql-16.4-dev","doc":"/nix/store/plf9diy9a5l5fmfl8pvlgmpxkc3ixhb3-postgresql-16.4-doc","lib":"/nix/store/l54jqbzqhghvy3g9kqhmcha9z3vzzrxr-postgresql-16.4-lib","man":"/nix/store/43pzfj4xv6r022jmnmx2n648ycqy8rhx-postgresql-16.4-man","out":"/nix/store/1gax5xs6h1b70gk7z274kx4qh04hsn96-postgresql-16.4"},"outputs_to_install":["out","man"],"pname":"postgresql_16","priority":5,"rev":"06cf0e1da4208d3766d898b7fdab6513366d45b9","rev_count":687049,"rev_date":"2024-09-29T18:20:51Z","scrape_date":"2024-10-01T03:19:19Z","stabilities":["unstable"],"system":"x86_64-linux","unfree":false,"version":"postgresql-16.4"}]}